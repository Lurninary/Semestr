{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://semestr/./YouTubeAPI.mjs","webpack://semestr/./main.js"],"sourcesContent":["class YouTubeVideo {\r\n    constructor(id, title, author, preview, upload, views, duration)\r\n    {\r\n        this.id = id\r\n        this.title = title\r\n        this.author = author\r\n        this.preview = preview\r\n        this.upload = upload\r\n        this.views = views\r\n        this.duration = duration\r\n    }\r\n\r\n    static searchConstructor(id, title, author, preview, upload)\r\n    {\r\n        return new YouTubeVideo(id, title, author, preview, upload, \"\", \"\")\r\n    }\r\n}\r\n\r\nclass YouTubeAPI {\r\n    constructor(apiKey) {\r\n        this.apiKey = apiKey;\r\n    }\r\n\r\n    getVideoDetails(videoId) {\r\n        const url = `https://youtube.googleapis.com/youtube/v3/videos?part=snippet,statistics,contentDetails,id&id=${videoId}&key=${this.apiKey}`;\r\n        let DataArray = []\r\n        \r\n        console.log(`getVideoDetails: Sending request to ${url}`);\r\n        return fetch(url)\r\n        .then(response => response.json())\r\n        .then(data => {\r\n            DataArray.push(new YouTubeVideo(\r\n            data.items[0].id,\r\n            data.items[0].snippet.title,\r\n            data.items[0].snippet.channelTitle,\r\n            data.items[0].snippet.thumbnails.high.url,\r\n            data.items[0].snippet.publishedAt,\r\n            data.items[0].statistics.viewCount,\r\n            data.items[0].contentDetails.duration\r\n            ))\r\n\r\n            return DataArray;\r\n        });\r\n    }\r\n\r\n    searchVideosWithFilters(query, maxResults, filters) {\r\n        let url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${query}&type=video&maxResults=${maxResults}&key=${this.apiKey}`;\r\n        let DataArray = []\r\n\r\n        if (filters) {\r\n            if (filters.orderBy) {\r\n                url += `&order=${filters.orderBy}`;\r\n            }\r\n            if (filters.publishedAfter) {\r\n                url += `&publishedAfter=${filters.publishedAfter}`;\r\n            }\r\n            if (filters.publishedBefore) {\r\n                url += `&publishedBefore=${filters.publishedBefore}`;\r\n            }\r\n            if (filters.videoDefinition) {\r\n                url += `&videoDefinition=${filters.videoDefinition}`;\r\n            }\r\n        }\r\n        console.log(`searchVideosWithFilters: Sending request to ${url}`);\r\n\r\n        return fetch(url)\r\n        .then(response => response.json())\r\n        .then(data => {\r\n            for(let i=0; i<data.items.length; i++){\r\n                DataArray.push(YouTubeVideo.searchConstructor(\r\n                data.items[i].id.videoId,\r\n                data.items[i].snippet.title,\r\n                data.items[i].snippet.channelTitle,\r\n                data.items[i].snippet.thumbnails.high.url,\r\n                data.items[i].snippet.publishedAt\r\n                ))\r\n            }\r\n            \r\n            return DataArray;\r\n        });\r\n    }\r\n}\r\n\r\nexport {YouTubeAPI, YouTubeVideo};","import { YouTubeAPI } from \"./YouTubeAPI.mjs\"\r\n\r\nconst apiKey = 'AIzaSyCXAv-2ZqSYc3BCF0ZL04t3ynrnrECTkQ0'\r\nconst youtube = new YouTubeAPI(apiKey);\r\n\r\nconst videosTable = document.getElementById('videos')\r\nconst searchTable = document.getElementById('searchData')\r\nconst infoTable = document.getElementById('videoInfo')\r\n\r\nconst docTitle = document.getElementById('userName')\r\nconst webLink = document.getElementById('link')\r\nconst searchButton = document.getElementById('search_button')\r\nconst getVideo = document.getElementById('get_video')\r\nconst deleteVideo = document.getElementById('deleteButton')\r\nconst query = document.getElementById('query')\r\nconst addButton = document.getElementById('addButton')\r\n\r\nconst dateCb = document.getElementById('dateFilter')\r\nconst ratingCb = document.getElementById('ratingFilter')\r\nconst viewCountCb = document.getElementById('viewCountFilter')\r\n\r\nlet name = prompt(\"Привет! Как вас зовут?\")\r\ndocTitle.textContent = \"Привет, \" + name + \"!\";\r\n\r\nlet videosData = []\r\nlet searchData = []\r\nlet filters = {\r\n    type: \"video\",\r\n    orderBy: \"\",\r\n    videoDefinition: \"high\",\r\n    videoEmbeddable: \"true\"\r\n};\r\n\r\nfunction renderTable(data, table)\r\n{\r\n    table.innerHTML=''\r\n    console.log(\"start render \" + table.id)\r\n    let firstRow = document.createElement('tr')\r\n    \r\n    for (let attr in data[0])\r\n    {\r\n        let firstColumn = document.createElement('th')\r\n        firstColumn.textContent = attr\r\n        firstRow.appendChild(firstColumn)\r\n    }\r\n    table.appendChild(firstRow)\r\n    for (let video of data)\r\n    {\r\n        let row = document.createElement('tr')\r\n\r\n        for (let item in video)\r\n        {\r\n            if (item !== '')\r\n            {\r\n                let column = document.createElement('th')\r\n\r\n                if(item != \"preview\")\r\n                {\r\n                    column.textContent = video[item] \r\n                }else {\r\n                    let link = document.createElement(\"a\")\r\n                    link.href = 'https://www.youtube.com/watch?v=' + video.id\r\n                    \r\n                    let image = document.createElement(\"img\")\r\n                    image.src = video[item]\r\n                    link.appendChild(image)\r\n                    column.appendChild(link)\r\n                }\r\n                row.appendChild(column)\r\n            }\r\n        }\r\n        \r\n        if(table.id != 'videoInfo')\r\n        {\r\n            setListener(row, 'click', () => {\r\n                if(row.id != 'selected')\r\n                {\r\n                    row.id = 'selected'\r\n                    row.className = table.id\r\n                    row.style.backgroundColor = 'lightblue'\r\n                    console.log(row)\r\n                } else {\r\n                    row.id = ''\r\n                    row.className = ''\r\n                    row.style.backgroundColor = document.getElementById('searchData').style.backgroundColor\r\n                }\r\n                \r\n            })\r\n        }\r\n\r\n        table.appendChild(row)\r\n    }\r\n}\r\n\r\nconst setListener = (element, type, handler) => {\r\n    console.log(\"Adding listener to \" + element.id)\r\n    if (!element) \r\n    {\r\n        return\r\n    }\r\n\r\n    element.addEventListener(type, handler)\r\n    return () => {\r\n        element.removeEventListener(type, handler)\r\n    }\r\n    \r\n}\r\n\r\nfunction selectRows() {\r\n    let selectedRows = []\r\n\r\n    for (let item of document.querySelectorAll('tr'))\r\n    {\r\n        if(item.id == 'selected')\r\n        {\r\n            selectedRows.push(item)\r\n        } \r\n    }\r\n    return selectedRows\r\n}\r\n\r\nfunction checkboxesInit() {\r\n    const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\r\n    \r\n    checkboxes.forEach((checkbox) => {\r\n        setListener(checkbox, 'click', () => {\r\n        checkboxes.forEach((cb) => {\r\n            if (cb !== checkbox && cb.checked) \r\n            {\r\n                cb.checked = false\r\n            }\r\n        })\r\n    \r\n        if (checkbox.checked) \r\n        {\r\n            filters.orderBy = checkbox.value\r\n        }\r\n        })\r\n    })\r\n}\r\n\r\ncheckboxesInit()\r\n\r\nsetListener(addButton, 'click', async () => {\r\n    console.log('Add')\r\n    for (let item of selectRows())\r\n    {\r\n        if (item.className == \"searchData\")\r\n        {\r\n            let searchId = searchData[item.rowIndex - 1].id\r\n\r\n            let video = await youtube.getVideoDetails(searchId)\r\n            console.log(video)\r\n            videosData.push(video[0])\r\n            item.click()\r\n        }\r\n    }\r\n    \r\n    videosData = videosData.filter((item, index) => {\r\n        return !videosData.slice(0, index).some((prevItem) => {\r\n            return prevItem.id === item.id\r\n        })\r\n    })\r\n    renderTable(videosData, videosTable)\r\n});\r\n\r\nsetListener(getVideo, 'click', async () => {\r\n    youtube.getVideoDetails(webLink.value.replace('https://www.youtube.com/watch?v=', ''))\r\n    .then(video => {\r\n        console.log(video);\r\n        renderTable(video, infoTable)\r\n    })\r\n    .catch(error => {\r\n        console.error(error);\r\n    });\r\n})\r\n\r\nsetListener(webLink, 'keypress', (event) => {\r\n    if(event.key === 'Enter' && webLink)\r\n    {\r\n        event.preventDefault()\r\n        getVideo.click()\r\n    }\r\n})\r\n\r\nsetListener(deleteVideo, 'click', () => {\r\n    console.log('Delete')\r\n    for (let item of selectRows())\r\n    {\r\n        if (item.className == 'videos')\r\n        {\r\n            delete videosData[item.rowIndex ]\r\n        \r\n            videosData = videosData.filter(item => Object.keys(item).length !== 0)\r\n        }\r\n    }\r\n    renderTable(videosData, videosTable)\r\n})\r\n\r\nsetListener(searchButton, 'click', async () => {\r\n    searchData = []\r\n    youtube.searchVideosWithFilters(query.value, 5, filters)\r\n    .then(async (videos) => {\r\n        console.log(videos);\r\n        for (let item of videos) \r\n        {\r\n            let searchVideos = await youtube.getVideoDetails(item.id)\r\n            console.log(searchVideos[0])\r\n            searchData.push(searchVideos[0])\r\n            console.log(searchData)\r\n        }\r\n        renderTable(searchData, searchTable)\r\n    })\r\n    .catch(error => {\r\n        console.error(error);\r\n    });\r\n})\r\n\r\nsetListener(query, 'keypress', (event) => {\r\n    if(event.key === 'Enter' && query)\r\n    {\r\n        event.preventDefault()\r\n        searchButton.click()\r\n    }\r\n})"],"names":["YouTubeVideo","constructor","id","title","author","preview","upload","views","duration","this","static","youtube","apiKey","getVideoDetails","videoId","url","DataArray","console","log","fetch","then","response","json","data","push","items","snippet","channelTitle","thumbnails","high","publishedAt","statistics","viewCount","contentDetails","searchVideosWithFilters","query","maxResults","filters","orderBy","publishedAfter","publishedBefore","videoDefinition","i","length","searchConstructor","videosTable","document","getElementById","searchTable","infoTable","docTitle","webLink","searchButton","getVideo","deleteVideo","addButton","prompt","textContent","videosData","searchData","type","videoEmbeddable","renderTable","table","innerHTML","firstRow","createElement","attr","firstColumn","appendChild","video","row","item","column","link","href","image","src","setListener","className","style","backgroundColor","element","handler","addEventListener","removeEventListener","selectRows","selectedRows","querySelectorAll","checkboxes","forEach","checkbox","cb","checked","value","checkboxesInit","async","searchId","rowIndex","click","filter","index","slice","some","prevItem","replace","catch","error","event","key","preventDefault","Object","keys","videos","searchVideos"],"sourceRoot":""}